{"ast":null,"code":"import React, { Component } from 'react';\nimport Axios from 'axios';\n\nvar express = require(\"express\");\n\nvar router = express.Router();\n\nvar path = require(\"path\");\n\nvar request = require(\"request\");\n\nvar cheerio = require(\"cheerio\");\n\nvar Article = require(\"../models/Article.js\");\n\nrouter.get(\"/\", function (req, res) {\n  res.redirect(\"/articles\");\n});\nrouter.get(\"/scrape\", function (req, res) {\n  request(\"http://www.nba.com\", function (error, response, html) {\n    var $ = cheerio.load(html);\n    var titlesArray = [];\n    $(\".content_list--item_wrapper a\").each(function (i, element) {\n      var result = {};\n      result.title = $(this).children(\"h5\").text();\n      result.link = $(this).attr(\"href\");\n\n      if (result.title !== \"\" && result.link !== \"\") {\n        if (titlesArray.indexOf(result.title) == -1) {\n          titlesArray.push(result.title);\n          Article.count({\n            title: result.title\n          }, function (err, test) {\n            if (test === 0) {\n              var entry = new Article(result);\n              entry.save(function (err, doc) {\n                if (err) {\n                  console.log(err);\n                } else {\n                  console.log(doc);\n                }\n              });\n            }\n          });\n        } else {\n          console.log(\"Article already exists.\");\n        }\n      } else {\n        console.log(\"Not saved to DB, missing data\");\n      }\n    });\n    res.redirect(\"/\");\n  });\n});\nrouter.get(\"/articles\", function (req, res) {\n  Article.find().sort({\n    _id: -1\n  }).exec(function (err, doc) {\n    if (err) {\n      console.log(err);\n    } else {\n      var artcl = {\n        article: doc\n      };\n      res.render(\"index\", artcl);\n    }\n  });\n});\nrouter.get(\"/articles-json\", function (req, res) {\n  Article.find({}, function (err, doc) {\n    if (err) {\n      console.log(err);\n    } else {\n      res.json(doc);\n    }\n  });\n});\nrouter.get(\"/clearAll\", function (req, res) {\n  Article.remove({}, function (err, doc) {\n    if (err) {\n      console.log(err);\n    } else {\n      console.log(\"removed all articles\");\n    }\n  });\n  res.redirect(\"/articles-json\");\n});\nrouter.get(\"/readArticle/:id\", function (req, res) {\n  var articleId = req.params.id;\n  var hbsObj = {\n    article: [],\n    body: []\n  };\n  Article.findOne({\n    _id: articleId\n  }).populate(\"comment\").exec(function (err, doc) {\n    if (err) {\n      console.log(\"Error: \" + err);\n    } else {\n      hbsObj.article = doc;\n      var link = doc.link;\n      request(link, function (error, response, html) {\n        var $ = cheerio.load(html);\n        $(\".l-col__main\").each(function (i, element) {\n          hbsObj.body = $(this).children(\".c-entry-content\").children(\"p\").text();\n          res.render(\"article\", hbsObj);\n          return false;\n        });\n      });\n    }\n  });\n});\nrouter.post(\"/comment/:id\", function (req, res) {\n  var user = req.body.name;\n  var content = req.body.comment;\n  var articleId = req.params.id;\n  var commentObj = {\n    name: user,\n    body: content\n  };\n  var newComment = new Comment(commentObj);\n  newComment.save(function (err, doc) {\n    if (err) {\n      console.log(err);\n    } else {\n      console.log(doc._id);\n      console.log(articleId);\n      Article.findOneAndUpdate({\n        _id: req.params.id\n      }, {\n        $push: {\n          comment: doc._id\n        }\n      }, {\n        new: true\n      }).exec(function (err, doc) {\n        if (err) {\n          console.log(err);\n        } else {\n          res.redirect(\"/readArticle/\" + articleId);\n        }\n      });\n    }\n  });\n});\nmodule.exports = router;","map":{"version":3,"sources":["C:\\Users\\joeki\\desktop\\pokedex\\src\\components\\news\\News.js"],"names":["React","Component","Axios","express","require","router","Router","path","request","cheerio","Article","get","req","res","redirect","error","response","html","$","load","titlesArray","each","i","element","result","title","children","text","link","attr","indexOf","push","count","err","test","entry","save","doc","console","log","find","sort","_id","exec","artcl","article","render","json","remove","articleId","params","id","hbsObj","body","findOne","populate","post","user","name","content","comment","commentObj","newComment","Comment","findOneAndUpdate","$push","new","module","exports"],"mappings":"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","sourcesContent":["\r\nimport React, { Component } from 'react';\r\nimport Axios from 'axios';\r\n\r\n\r\n\r\n\r\n\r\nvar express = require(\"express\");\r\n\r\nvar router = express.Router();\r\n\r\nvar path = require(\"path\");\r\n\r\n\r\n\r\nvar request = require(\"request\");\r\n\r\nvar cheerio = require(\"cheerio\");\r\n\r\n\r\n\r\nvar Article = require(\"../models/Article.js\");\r\n\r\n\r\n\r\nrouter.get(\"/\", function(req, res) {\r\n\r\n  res.redirect(\"/articles\");\r\n\r\n});\r\n\r\n\r\n\r\nrouter.get(\"/scrape\", function(req, res) {\r\n\r\n  request(\"http://www.nba.com\", function(error, response, html) {\r\n\r\n    var $ = cheerio.load(html);\r\n\r\n    \r\n\r\n    var titlesArray = [];\r\n\r\n\r\n\r\n    $(\".content_list--item_wrapper a\").each(function(i, element) {\r\n\r\n      var result = {};\r\n\r\n\r\n\r\n      result.title = $(this)\r\n\r\n        .children(\"h5\")\r\n\r\n        .text();\r\n\r\n      result.link = $(this)\r\n\r\n        .attr(\"href\");\r\n\r\n        \r\n\r\n\r\n\r\n      if (result.title !== \"\" && result.link !== \"\") {\r\n\r\n        if (titlesArray.indexOf(result.title) == -1) {\r\n\r\n          titlesArray.push(result.title);\r\n\r\n\r\n\r\n          Article.count({ title: result.title }, function(err, test) {\r\n\r\n            if (test === 0) {\r\n\r\n              var entry = new Article(result);\r\n\r\n\r\n\r\n              entry.save(function(err, doc) {\r\n\r\n                if (err) {\r\n\r\n                  console.log(err);\r\n\r\n                } else {\r\n\r\n                  console.log(doc);\r\n\r\n                }\r\n\r\n              });\r\n\r\n            }\r\n\r\n          });\r\n\r\n        } else {\r\n\r\n          console.log(\"Article already exists.\");\r\n\r\n        }\r\n\r\n      } else {\r\n\r\n        console.log(\"Not saved to DB, missing data\");\r\n\r\n      }\r\n\r\n    });\r\n\r\n    \r\n\r\n    res.redirect(\"/\");\r\n\r\n  });\r\n\r\n});\r\n\r\nrouter.get(\"/articles\", function(req, res) {\r\n\r\n  Article.find()\r\n\r\n    .sort({ _id: -1 })\r\n\r\n    .exec(function(err, doc) {\r\n\r\n      if (err) {\r\n\r\n        console.log(err);\r\n\r\n      } else {\r\n\r\n        var artcl = { article: doc };\r\n\r\n        res.render(\"index\", artcl);\r\n\r\n      }\r\n\r\n    });\r\n\r\n});\r\n\r\n\r\n\r\nrouter.get(\"/articles-json\", function(req, res) {\r\n\r\n  Article.find({}, function(err, doc) {\r\n\r\n    if (err) {\r\n\r\n      console.log(err);\r\n\r\n    } else {\r\n\r\n      res.json(doc);\r\n\r\n    }\r\n\r\n  });\r\n\r\n});\r\n\r\n\r\n\r\nrouter.get(\"/clearAll\", function(req, res) {\r\n\r\n  Article.remove({}, function(err, doc) {\r\n\r\n    if (err) {\r\n\r\n      console.log(err);\r\n\r\n    } else {\r\n\r\n      console.log(\"removed all articles\");\r\n\r\n    }\r\n\r\n  });\r\n\r\n  res.redirect(\"/articles-json\");\r\n\r\n});\r\n\r\n\r\n\r\nrouter.get(\"/readArticle/:id\", function(req, res) {\r\n\r\n  var articleId = req.params.id;\r\n\r\n  var hbsObj = {\r\n\r\n    article: [],\r\n\r\n    body: []\r\n\r\n  };\r\n\r\n\r\n\r\n  Article.findOne({ _id: articleId })\r\n\r\n    .populate(\"comment\")\r\n\r\n    .exec(function(err, doc) {\r\n\r\n      if (err) {\r\n\r\n        console.log(\"Error: \" + err);\r\n\r\n      } else {\r\n\r\n        hbsObj.article = doc;\r\n\r\n        var link = doc.link;\r\n\r\n        request(link, function(error, response, html) {\r\n\r\n          var $ = cheerio.load(html);\r\n\r\n\r\n\r\n          $(\".l-col__main\").each(function(i, element) {\r\n\r\n            hbsObj.body = $(this)\r\n\r\n              .children(\".c-entry-content\")\r\n\r\n              .children(\"p\")\r\n\r\n              .text();\r\n\r\n\r\n\r\n            res.render(\"article\", hbsObj);\r\n\r\n            return false;\r\n\r\n          });\r\n\r\n        });\r\n\r\n      }\r\n\r\n    });\r\n\r\n});\r\n\r\nrouter.post(\"/comment/:id\", function(req, res) {\r\n\r\n  var user = req.body.name;\r\n\r\n  var content = req.body.comment;\r\n\r\n  var articleId = req.params.id;\r\n\r\n\r\n\r\n  var commentObj = {\r\n\r\n    name: user,\r\n\r\n    body: content\r\n\r\n  };\r\n\r\n\r\n\r\n  var newComment = new Comment(commentObj);\r\n\r\n\r\n\r\n  newComment.save(function(err, doc) {\r\n\r\n    if (err) {\r\n\r\n      console.log(err);\r\n\r\n    } else {\r\n\r\n      console.log(doc._id);\r\n\r\n      console.log(articleId);\r\n\r\n\r\n\r\n      Article.findOneAndUpdate(\r\n\r\n        { _id: req.params.id },\r\n\r\n        { $push: { comment: doc._id } },\r\n\r\n        { new: true }\r\n\r\n      ).exec(function(err, doc) {\r\n\r\n        if (err) {\r\n\r\n          console.log(err);\r\n\r\n        } else {\r\n\r\n          res.redirect(\"/readArticle/\" + articleId);\r\n\r\n        }\r\n\r\n      });\r\n\r\n    }\r\n\r\n  });\r\n\r\n});\r\n\r\n\r\n\r\nmodule.exports = router;"]},"metadata":{},"sourceType":"module"}